///	Copyright (c) 2010-2022
///	Threading Core Render Engine
///
///	作者：彭武阳，彭晔恩，彭晔泽
///	联系作者：94458936@qq.com
///
///	标准：std:c++20
///	引擎测试版本：0.8.0.8 (2022/05/15 13:22)

#include "FormatErrorMessageUseDllMoudleAndLocalAllocTesting.h"
#include "System/CharacterString/FormatErrorMessage.h"
#include "System/DynamicLink/Flags/LoadLibraryFlags.h"
#include "System/DynamicLink/LoadLibrary.h"
#include "System/MemoryTools/LocalTools.h"
#include "System/Windows/Flags/PlatformErrorFlags.h"
#include "CoreTools/Helper/AssertMacro.h"
#include "CoreTools/Helper/ClassInvariant/SystemClassInvariantMacro.h"
#include "CoreTools/UnitTestSuite/UnitTestDetail.h"

using namespace std::literals;

ENUM_INCREMENTABLE_OPERATOR_DEFINE(System::WindowError);

System::FormatErrorMessageUseDllMoudleAndLocalAllocTesting::FormatErrorMessageUseDllMoudleAndLocalAllocTesting(const OStreamShared& stream)
    : ParentType{ stream },
      windowErrorFlags{ WindowError::Success,
                        WindowError::NoError,
                        WindowError::SecEOk,
                        WindowError::InvalidFunction,
                        WindowError::FileNotFound,
                        WindowError::PathNotFound,
                        WindowError::TooManyOpenFiles,
                        WindowError::AccessDenied,
                        WindowError::InvalidHandle,
                        WindowError::ArenaTrashed,
                        WindowError::NotEnoughMemory,
                        WindowError::InvalidBlock,
                        WindowError::BadEnvironment,
                        WindowError::BadFormat,
                        WindowError::InvalidAccess,
                        WindowError::InvalidData,
                        WindowError::OutofMemory,
                        WindowError::InvalidDrive,
                        WindowError::CurrentDirectory,
                        WindowError::NotSameDevice,
                        WindowError::NoMoreFiles,
                        WindowError::WriteProtect,
                        WindowError::BadUnit,
                        WindowError::NotReady,
                        WindowError::BadCommand,
                        WindowError::Crc,
                        WindowError::BadLength,
                        WindowError::Seek,
                        WindowError::NotDosDisk,
                        WindowError::SectorNotFound,
                        WindowError::OutOfPaper,
                        WindowError::WriteFault,
                        WindowError::ReadFault,
                        WindowError::GenFailure,
                        WindowError::SharingViolation,
                        WindowError::LockViolation,
                        WindowError::WrongDisk,
                        WindowError::SharingBufferExceeded,
                        WindowError::HandleEof,
                        WindowError::HandleDiskFull,
                        WindowError::NotSupported,
                        WindowError::RemNotList,
                        WindowError::DupName,
                        WindowError::BadNetpath,
                        WindowError::NetworkBusy,
                        WindowError::DevNotExist,
                        WindowError::TooManyCmds,
                        WindowError::AdapHdwErr,
                        WindowError::BadNetResp,
                        WindowError::UnexpNetErr,
                        WindowError::BadRemAdap,
                        WindowError::PrintqFull,
                        WindowError::NoSpoolSpace,
                        WindowError::PrintCancelled,
                        WindowError::NetnameDeleted,
                        WindowError::NetworkAccessDenied,
                        WindowError::BadDevType,
                        WindowError::BadNetName,
                        WindowError::TooManyNames,
                        WindowError::TooManySess,
                        WindowError::SharingPaused,
                        WindowError::ReqNotAccep,
                        WindowError::RedirPaused,
                        WindowError::FileExists,
                        WindowError::CannotMake,
                        WindowError::FailI24,
                        WindowError::OutOfStructures,
                        WindowError::AlreadyAssigned,
                        WindowError::InvalidPassword,
                        WindowError::InvalidParameter,
                        WindowError::NetWriteFault,
                        WindowError::NoProcSlots,
                        WindowError::TooManySemaphores,
                        WindowError::ExclSemAlreadyOwned,
                        WindowError::SemIsSet,
                        WindowError::TooManySemRequests,
                        WindowError::InvalidAtInterruptTime,
                        WindowError::SemOwnerDied,
                        WindowError::SemUserLimit,
                        WindowError::DiskChange,
                        WindowError::DriveLocked,
                        WindowError::BrokenPipe,
                        WindowError::OpenFailed,
                        WindowError::BufferOverflow,
                        WindowError::DiskFull,
                        WindowError::NoMoreSearchHandles,
                        WindowError::InvalidTargetHandle,
                        WindowError::InvalidCategory,
                        WindowError::InvalidVerifySwitch,
                        WindowError::BadDriverLevel,
                        WindowError::CallNotImlemented,
                        WindowError::SemTimeOut,
                        WindowError::InsuffcientBuffer,
                        WindowError::InvalidName,
                        WindowError::InvalidLevel,
                        WindowError::NoVolumeLabel,
                        WindowError::ModNotFound,
                        WindowError::ProcNotFound,
                        WindowError::WaitNoChildren,
                        WindowError::ChildNotComplete,
                        WindowError::DirectAccessHandle,
                        WindowError::NegativeSeek,
                        WindowError::SeekOnDevice,
                        WindowError::IsJoinTarget,
                        WindowError::IsJoined,
                        WindowError::IsSubsted,
                        WindowError::NotJoined,
                        WindowError::NotSubsted,
                        WindowError::JoinToJoin,
                        WindowError::SubstToSubst,
                        WindowError::JoinToSubst,
                        WindowError::SubstToJoin,
                        WindowError::BusyDrive,
                        WindowError::SameDrive,
                        WindowError::DirNotRoot,
                        WindowError::DirNotEmpty,
                        WindowError::IsSubstPath,
                        WindowError::IsJoinPath,
                        WindowError::PathBusy,
                        WindowError::IsSubstTarget,
                        WindowError::SystemTrace,
                        WindowError::InvalidEventCount,
                        WindowError::TooManyMuxwaiters,
                        WindowError::InvalidListFormat,
                        WindowError::LabelTooLong,
                        WindowError::TooManyTcbs,
                        WindowError::SignalRefused,
                        WindowError::Discarded,
                        WindowError::NotLocked,
                        WindowError::BadThreadidAddr,
                        WindowError::BadArguments,
                        WindowError::BadPathname,
                        WindowError::SignalPending,
                        WindowError::MaxThrdsReached,
                        WindowError::LockFailed,
                        WindowError::Busy,
                        WindowError::CancelViolation,
                        WindowError::AtomicLocksNotSupported,
                        WindowError::InvalidSegmentNumber,
                        WindowError::InvalidOrdinal,
                        WindowError::AlreadyExists,
                        WindowError::InvalidFlagNumber,
                        WindowError::SemNotFound,
                        WindowError::InvalidStartingCodeseg,
                        WindowError::InvalidStackseg,
                        WindowError::InvalidModuletype,
                        WindowError::InvalidExeSignature,
                        WindowError::ExeMarkedInvalid,
                        WindowError::BadExeFormat,
                        WindowError::IteratedDataExceeds64k,
                        WindowError::InvalidMinallocsize,
                        WindowError::DynlinkFromInvalidRing,
                        WindowError::IoplNotEnabled,
                        WindowError::InvalidSegdpl,
                        WindowError::AutodatasegExceeds64k,
                        WindowError::Ring2segMustBeMovable,
                        WindowError::RelocChaniXeedsSeglim,
                        WindowError::InfloopInRelocChain,
                        WindowError::EnvvarNotFound,
                        WindowError::NoSignalSent,
                        WindowError::FilenameExcedRange,
                        WindowError::Ring2StackInUse,
                        WindowError::MetaExpansionTooLong,
                        WindowError::InvalidSignalNumber,
                        WindowError::Thread1Inactive,
                        WindowError::Locked,
                        WindowError::TooManyModules,
                        WindowError::NestingNotAllowed,
                        WindowError::ExeMachineTypeMismatch,
                        WindowError::ExeCannotModifySignedBinary,
                        WindowError::ExeCannotModifyStrongSignedBinary,
                        WindowError::FileCheckedOut,
                        WindowError::CheckoutRequired,
                        WindowError::BadFileType,
                        WindowError::FileTooLarge,
                        WindowError::FormsAuthRequired,
                        WindowError::VirusInfected,
                        WindowError::VirusDeleted,
                        WindowError::PipeLocal,
                        WindowError::BadPipe,
                        WindowError::PipeBusy,
                        WindowError::NoData,
                        WindowError::PipeNotConnected,
                        WindowError::MoreData,
                        WindowError::VCDisconnected,
                        WindowError::InvalidEaName,
                        WindowError::EaListInconsistent,
                        WindowError::WaitTimeout,
                        WindowError::NoMoreItems,
                        WindowError::CannotCopy,
                        WindowError::Directory,
                        WindowError::EasDidntFit,
                        WindowError::EaFileCorrurt,
                        WindowError::EaTableFull,
                        WindowError::InvalidEaHandle,
                        WindowError::EasNotSupported,
                        WindowError::NotOwner,
                        WindowError::TooManyPosts,
                        WindowError::PartialCopy,
                        WindowError::OplockNotGranted,
                        WindowError::InvalidOplockProtocol,
                        WindowError::DiskTooFragmented,
                        WindowError::DeletePending,
                        WindowError::IncompatibleWithGlobalShortNameRegistrySetting,
                        WindowError::ShortNamesNotEnabledOnVolume,
                        WindowError::SecurityStreamIsInconsistent,
                        WindowError::InvalidLockRange,
                        WindowError::ImageSubsystemNotPresent,
                        WindowError::NotificationGuidAlreadyDefined,
                        WindowError::MrMidNotFound,
                        WindowError::ScopeNotFound,
                        WindowError::FailNoactionReboot,
                        WindowError::FailShutdown,
                        WindowError::FailRestart,
                        WindowError::MaxSessionsReached,
                        WindowError::ThreadModeAlreadyBackground,
                        WindowError::ThreadModeNotBackground,
                        WindowError::ProcessModeAlreadyBackground,
                        WindowError::ProcessModeNotBackground,
                        WindowError::InvalidAddress,
                        WindowError::UserProfileLoad,
                        WindowError::ArithmeticOverflow,
                        WindowError::PipeConnected,
                        WindowError::PipeListenting,
                        WindowError::VerifierStop,
                        WindowError::AbiosError,
                        WindowError::Wx86Warning,
                        WindowError::Wx86Error,
                        WindowError::TimerNotCanceled,
                        WindowError::Unwind,
                        WindowError::BadStack,
                        WindowError::InvalidUnwindTarget,
                        WindowError::InvalidPortAttributes,
                        WindowError::PoptMessageTooLong,
                        WindowError::InvalidQuotaLower,
                        WindowError::DeviceAlreadyAttached,
                        WindowError::InstructionMisalignment,
                        WindowError::ProfilingNotStarted,
                        WindowError::ProfilingNotStopped,
                        WindowError::CouldNotInterpret,
                        WindowError::ProfilingAtLimit,
                        WindowError::CantWait,
                        WindowError::CantTerminateSelf,
                        WindowError::UnexpectedMMCreateErr,
                        WindowError::UnexpectedMMMapError,
                        WindowError::UnexpectedMMExtendErr,
                        WindowError::BadFunctionTable,
                        WindowError::NoGuidTranslation,
                        WindowError::InvalidLdtSize,
                        WindowError::InvalidLdtOffset,
                        WindowError::InvalidLdtDescriptor,
                        WindowError::TooManyThreads,
                        WindowError::ThreadNotInProcess,
                        WindowError::PagefileQuotaExceeded,
                        WindowError::LogonServerConflict,
                        WindowError::SynchronizationRequired,
                        WindowError::NetOpenFailed,
                        WindowError::IOPrivilegeFailed,
                        WindowError::ControlCExit,
                        WindowError::MissingSystemfile,
                        WindowError::UnhandledException,
                        WindowError::AppInitFailure,
                        WindowError::PagefileCreateFailed,
                        WindowError::InvalidImageHash,
                        WindowError::NoPagefile,
                        WindowError::IllegalFloatContext,
                        WindowError::NoEventPair,
                        WindowError::DomainCtrlrConfigError,
                        WindowError::IllegalCharacter,
                        WindowError::UndefinedCharacter,
                        WindowError::FloppyVolume,
                        WindowError::BiosFailedToConnectInterrupt,
                        WindowError::BackupController,
                        WindowError::MutantLimitExceeded,
                        WindowError::FsDriverRequired,
                        WindowError::CannotLoadRegistryFile,
                        WindowError::DebugAttachFailed,
                        WindowError::SystemProcessTerminated,
                        WindowError::DataNotAccepted,
                        WindowError::VdmHardError,
                        WindowError::DriverCancelTimeout,
                        WindowError::ReplyMessageMismatch,
                        WindowError::LostWritebehindData,
                        WindowError::ClientServerPrarmetersInvalid,
                        WindowError::NotTinnyStream,
                        WindowError::StackOverflowRead,
                        WindowError::convertToLarge,
                        WindowError::FoundOutOfScope,
                        WindowError::AllocateBucket,
                        WindowError::MarshallOverflow,
                        WindowError::InvalidVariant,
                        WindowError::BadCompressionBuffer,
                        WindowError::AuditFailed,
                        WindowError::TimerResolutionNotSet,
                        WindowError::InsufficientLogonInfo,
                        WindowError::BadDllEntrypoint,
                        WindowError::BadServiceEntrypoint,
                        WindowError::IPAddressConflict1,
                        WindowError::IPAddressConflict2,
                        WindowError::RegistryQuotaLimit,
                        WindowError::NoCallbackActive,
                        WindowError::PwdTooShort,
                        WindowError::PwdTooRecent,
                        WindowError::PwdHistoryConflict,
                        WindowError::UnsupportedCompression,
                        WindowError::InvalidHwProfile,
                        WindowError::InvalidPlugplayDevicePath,
                        WindowError::QuotaListInconsistent,
                        WindowError::EvaluationExpiration,
                        WindowError::IllegalDllRelocation,
                        WindowError::DllInitFailedLogoff,
                        WindowError::ValidateContinue,
                        WindowError::NoMoreMatches,
                        WindowError::RangeListConflict,
                        WindowError::ServerSidMismatch,
                        WindowError::CantEnableDenyOnly,
                        WindowError::FloatMultipleFaults,
                        WindowError::FloatMultipleTraps,
                        WindowError::Nointerface,
                        WindowError::DriverFailedSleep,
                        WindowError::CorruptSystemFile,
                        WindowError::CommitmentMinimum,
                        WindowError::PnpRestartEnumeration,
                        WindowError::SystemImageBadSignature,
                        WindowError::PnpRebootRequired,
                        WindowError::InsufficientPower,
                        WindowError::MultipleFaultViolation,
                        WindowError::SystemShutdown,
                        WindowError::PortNotSet,
                        WindowError::DSVersionCheckFailure,
                        WindowError::RangeNotFound,
                        WindowError::NotSafeModeDriver,
                        WindowError::FailedDriverEntry,
                        WindowError::DeviceEnumerationError,
                        WindowError::MountPointNotResolved,
                        WindowError::InvalidDeviceObjectParameter,
                        WindowError::McaOccured,
                        WindowError::DriverDatabaseError,
                        WindowError::SystemHiveTooLarge,
                        WindowError::DriverFailedPriorUnload,
                        WindowError::VolsnapPrepareHibernate,
                        WindowError::HibernationFailure,
                        WindowError::FileSystemLimitation,
                        WindowError::AssertionFailure,
                        WindowError::AcpiError,
                        WindowError::WowAssertion,
                        WindowError::PnpBadMpsTable,
                        WindowError::PnpTranslationFailed,
                        WindowError::PnpIrqTranslationFailed,
                        WindowError::PnpInvalidID,
                        WindowError::WakeSystemDebugger,
                        WindowError::HandlesClosed,
                        WindowError::ExtraneousInformation,
                        WindowError::RxactCommitNecessary,
                        WindowError::MediaCheck,
                        WindowError::GuidSubstitutionMade,
                        WindowError::StoppedOnSymlink,
                        WindowError::Longjump,
                        WindowError::PlugplayQueryVetoed,
                        WindowError::UnwindConsolidate,
                        WindowError::RegistryHiveRecovered,
                        WindowError::DllMightBeInsecure,
                        WindowError::DllMightBeIncompatible,
                        WindowError::DbgExceptionNotHandled,
                        WindowError::DbgReplyLater,
                        WindowError::DbgUnableToProvideHandle,
                        WindowError::DbgTerminateThread,
                        WindowError::DbgTerminateProcess,
                        WindowError::DbgControlC,
                        WindowError::DbgPrintexceptionC,
                        WindowError::DbgRipexcetion,
                        WindowError::DbgControlBreak,
                        WindowError::DbgCommandException,
                        WindowError::ObjectNameExists,
                        WindowError::ThreadWasSuspended,
                        WindowError::ImageNotAtBase,
                        WindowError::RxactStateCreated,
                        WindowError::SegmentNotification,
                        WindowError::BadCurrentDirectory,
                        WindowError::FtReadRecoveryFromBackup,
                        WindowError::FtWriteRecovery,
                        WindowError::ImageMachineTypeMismatch,
                        WindowError::ReceivePartial,
                        WindowError::ReceiveExpedited,
                        WindowError::ReceivePartialExpedited,
                        WindowError::EventDone,
                        WindowError::EventPending,
                        WindowError::CheckingFileSystem,
                        WindowError::FatalAppExit,
                        WindowError::PredefinedHanlde,
                        WindowError::WasUnlocked,
                        WindowError::ServiceNotification,
                        WindowError::WasLocked,
                        WindowError::LogHardError,
                        WindowError::AlreadyWin32,
                        WindowError::ImageMachineTypeMismatchExe,
                        WindowError::NoYieldPerformed,
                        WindowError::TimerResumeIgnored,
                        WindowError::ArbitrationUnhandled,
                        WindowError::CardbusNotSupported,
                        WindowError::MpProcessorMismatch,
                        WindowError::Hibernated,
                        WindowError::ResumeHibernation,
                        WindowError::FirmwareUpdated,
                        WindowError::DriversLeakingLockedPages,
                        WindowError::WakeSystem,
                        WindowError::Wait1,
                        WindowError::Wait2,
                        WindowError::Wait3,
                        WindowError::Wait63,
                        WindowError::AbandonedWait0,
                        WindowError::AbandonedWait63,
                        WindowError::UserApc,
                        WindowError::KernelApc,
                        WindowError::Alerted,
                        WindowError::ElevationRequired,
                        WindowError::Reparse,
                        WindowError::OplockBreakInProgress,
                        WindowError::VolumeMounted,
                        WindowError::ReactCommitted,
                        WindowError::NotifyCleanup,
                        WindowError::PrimaryTransportConnectFailed,
                        WindowError::PageFaultTransition,
                        WindowError::PageFaultDemandZero,
                        WindowError::PageFaultCopyOnWrite,
                        WindowError::PageFaultGuardPage,
                        WindowError::PageFaultPagingFile,
                        WindowError::CanchePageLocked,
                        WindowError::CrashDump,
                        WindowError::BufferAllZeros,
                        WindowError::ReparseObject,
                        WindowError::ResoureRequirementsChanged,
                        WindowError::TranslationComplete,
                        WindowError::NothingToTerminate,
                        WindowError::ProcessNotInJob,
                        WindowError::ProcessInJob,
                        WindowError::VolsnapHibernateReady,
                        WindowError::FsfilterOpcompletedSuccessfully,
                        WindowError::InterruptVectorAlreadyConnected,
                        WindowError::InterruptStillConnected,
                        WindowError::WaitForOplock,
                        WindowError::DbgExceptionHandled,
                        WindowError::DbgContinue,
                        WindowError::CallbackPopStack,
                        WindowError::CompressionDisabled,
                        WindowError::CantFetchBackwards,
                        WindowError::CantScrollBackwards,
                        WindowError::RowsNotReleased,
                        WindowError::BadAccessorFlags,
                        WindowError::ErrorsEncountered,
                        WindowError::NotCapable,
                        WindowError::RequestOutOfSequence,
                        WindowError::VersionParseError,
                        WindowError::BadStartPosition,
                        WindowError::MemoryHardware,
                        WindowError::DiskRepairDisabled,
                        WindowError::InsufficientResourceForSpecifiedSharedSectionSize,
                        WindowError::SystemPowerstateTransition,
                        WindowError::SystemPowerstateComplexTrancition,
                        WindowError::McaException,
                        WindowError::AccessAuditByPolicy,
                        WindowError::AccessDisabledNoSaferUIByPolicy,
                        WindowError::AbandonHiberfile,
                        WindowError::LostWritebehindDataNetworkDisconnected,
                        WindowError::LostWritebehindDataNetworkServerError,
                        WindowError::LostWritebehindDataLocalDiskError,
                        WindowError::BadMcfgTable,
                        WindowError::OplockSwitchedToNewHandle,
                        WindowError::CannotGrantRequestedOplock,
                        WindowError::CannotBreakOplock,
                        WindowError::OplockHandleClosed,
                        WindowError::NoAceCondition,
                        WindowError::InvalidAceCondition,
                        WindowError::EaAccessDenied,
                        WindowError::OperationAborted,
                        WindowError::IOIncomplete,
                        WindowError::IOPending,
                        WindowError::NoAccess,
                        WindowError::SwapError,
                        WindowError::StackOverflow,
                        WindowError::InvalidMessage,
                        WindowError::CanNotComplete,
                        WindowError::InvalidFlags,
                        WindowError::UnrecognizedVolume,
                        WindowError::FileInvalid,
                        WindowError::FullScreenMode,
                        WindowError::NoToken,
                        WindowError::Baddb,
                        WindowError::Badkey,
                        WindowError::CantOpen,
                        WindowError::CantRead,
                        WindowError::CantWrite,
                        WindowError::RegistryRevovered,
                        WindowError::RegistryCorrupt,
                        WindowError::RegistryIOFailed,
                        WindowError::NotRegistryFile,
                        WindowError::KeyDeleted,
                        WindowError::NoLogSpace,
                        WindowError::KeyHasChildren,
                        WindowError::ChildMustBeVolatile,
                        WindowError::NotifyEnumDir,
                        WindowError::DependentServicesRunning,
                        WindowError::InvalidServiceControl,
                        WindowError::ServiceRequestTimeout,
                        WindowError::ServiceNoThread,
                        WindowError::ServiceDatabaseLocked,
                        WindowError::ServiceAlreadyRunning,
                        WindowError::InvalidServiceAccout,
                        WindowError::ServiceDisabled,
                        WindowError::CircularDependency,
                        WindowError::ServiceDoesNotExist,
                        WindowError::ServiceCannotAcceptCtrl,
                        WindowError::ErrorServiceNotActive,
                        WindowError::FailedServiceControllerConnect,
                        WindowError::ExceptionInService,
                        WindowError::DatabaseDoesNotExist,
                        WindowError::ServiceSpecificError,
                        WindowError::ProcessAborted,
                        WindowError::ServiceDependencyFail,
                        WindowError::ServiceLogonFailed,
                        WindowError::ServiceStartHang,
                        WindowError::InvalidServiceLock,
                        WindowError::ServiceMarkedForDelete,
                        WindowError::ServiceExists,
                        WindowError::AlreadyRunningLkg,
                        WindowError::ServiceDependencyDeleted,
                        WindowError::BootAlreayAccepted,
                        WindowError::ServiceNeverStarted,
                        WindowError::DuplicateServiceName,
                        WindowError::DiffrentServiceAccount,
                        WindowError::CannotDetectDriverFailure,
                        WindowError::CannotDetectProcessAbort,
                        WindowError::NoRecoveryProgram,
                        WindowError::ServiceNotInExe,
                        WindowError::NotSafebootService,
                        WindowError::EndOfMedia,
                        WindowError::FilemarkDetected,
                        WindowError::BeginningOfMedia,
                        WindowError::SetmarkDetected,
                        WindowError::NoDataDetected,
                        WindowError::ParitionFailure,
                        WindowError::InvalidBlockLength,
                        WindowError::DeviceNotPartitioned,
                        WindowError::UnableToLockMedia,
                        WindowError::UnableToUnloadMedia,
                        WindowError::MediaChanged,
                        WindowError::BusReset,
                        WindowError::NoMediaInDrive,
                        WindowError::NoUnicodeTranslation,
                        WindowError::DllInitFailed,
                        WindowError::ShutdownInProgress,
                        WindowError::NoShutdownInProgress,
                        WindowError::IODevice,
                        WindowError::SerialNoDevice,
                        WindowError::IrqBusy,
                        WindowError::MoreWrites,
                        WindowError::CounterTimeout,
                        WindowError::FloppyIDMarkNotFound,
                        WindowError::FloppyWrongCylinder,
                        WindowError::FloppyUnknownError,
                        WindowError::FloppyBadRegisters,
                        WindowError::DiskRecalibrateFailed,
                        WindowError::DiskOperationFailed,
                        WindowError::DiskResetFailed,
                        WindowError::EomOverflow,
                        WindowError::NotEnoughServerMemory,
                        WindowError::PossibleDeadlock,
                        WindowError::MappedAlignment,
                        WindowError::SetPowerStateVetoed,
                        WindowError::SetPowerStateFailed,
                        WindowError::TooManyLinks,
                        WindowError::OldWinVersion,
                        WindowError::AppWrongOs,
                        WindowError::SingleInstanceApp,
                        WindowError::RmodeApp,
                        WindowError::InvalidDll,
                        WindowError::NoAssociation,
                        WindowError::DdeFail,
                        WindowError::DllNotFound,
                        WindowError::NoMoreUserHandles,
                        WindowError::MessageSyncOnly,
                        WindowError::SourceElementEmpty,
                        WindowError::DestinationElementFull,
                        WindowError::IllegalElementAddress,
                        WindowError::MagazineNotPresent,
                        WindowError::DeviceReinitializationNeeded,
                        WindowError::DeviceRequiresCleaning,
                        WindowError::DeviceDoorOpen,
                        WindowError::DeviceNotConnected,
                        WindowError::NotFound,
                        WindowError::NoMatch,
                        WindowError::SetNotFound,
                        WindowError::PointNotFound,
                        WindowError::NoTrackingService,
                        WindowError::NoVolumeID,
                        WindowError::UnableToRemoveReplaced,
                        WindowError::UnableToMoveReplacement,
                        WindowError::UnableToMoveReplacement2,
                        WindowError::JournalDeleteInProgress,
                        WindowError::JournalNotActive,
                        WindowError::PotentialFileFound,
                        WindowError::JournalEntryDeleted,
                        WindowError::ShutdownIsScheduled,
                        WindowError::ShutdownUsersLoggedOn,
                        WindowError::BadDevice,
                        WindowError::ConnectionUnavail,
                        WindowError::DeviceAlreadyRemembered,
                        WindowError::NotNetOrBadPath,
                        WindowError::BadProvider,
                        WindowError::CannotOpenProfile,
                        WindowError::BadProfile,
                        WindowError::NotContainer,
                        WindowError::ExtendedError,
                        WindowError::InvalidGroupname,
                        WindowError::InvalidComputername,
                        WindowError::InvalidEventname,
                        WindowError::InvalidDomainname,
                        WindowError::InvalidServicename,
                        WindowError::InvalidNetname,
                        WindowError::InvalidSharename,
                        WindowError::InvalidPasswordname,
                        WindowError::InvalidMessagename,
                        WindowError::InvalidMessagedest,
                        WindowError::SessionCredentialConflict,
                        WindowError::RemoteSessionLimitExceeded,
                        WindowError::DupDomainname,
                        WindowError::NoNetwork,
                        WindowError::Cancelled,
                        WindowError::UserMappedFile,
                        WindowError::ConnectionRefused,
                        WindowError::GracefulDisconnect,
                        WindowError::AddressAlreadyAssociated,
                        WindowError::AddressNotAssociated,
                        WindowError::ConnectionInvalid,
                        WindowError::ConnectionActive,
                        WindowError::NetworkUnreachable,
                        WindowError::HostUnreachable,
                        WindowError::ProtocolUnreachable,
                        WindowError::PortUnreachable,
                        WindowError::RequestAborted,
                        WindowError::ConnectionAborted,
                        WindowError::Retry,
                        WindowError::ConnectionCountLimit,
                        WindowError::LoginTimeRestriction,
                        WindowError::LoginWkstaRestriction,
                        WindowError::IncorrectAddress,
                        WindowError::AlreadyRegistered,
                        WindowError::ServiceNotFound,
                        WindowError::NotAuthenticated,
                        WindowError::NotLoggedOn,
                        WindowError::Continue,
                        WindowError::AlreadyInitialized,
                        WindowError::NoMoreDevices,
                        WindowError::NoSuchSite,
                        WindowError::DomainControllerExists,
                        WindowError::OnlyIfConnected,
                        WindowError::OverrideNochanges,
                        WindowError::BadUserProfile,
                        WindowError::NotSupportedOnSbs,
                        WindowError::ServerShutdownInProgress,
                        WindowError::HostDown,
                        WindowError::NonAccountSid,
                        WindowError::NonDomainSid,
                        WindowError::ApphelpBlock,
                        WindowError::AccessDisabledByPolicy,
                        WindowError::RegNatConsumption,
                        WindowError::CscshareOffline,
                        WindowError::PkinitFailure,
                        WindowError::SmartcardSubsystemFailure,
                        WindowError::DowngradeDetected,
                        WindowError::MachineLocked,
                        WindowError::CallbackSuppliedInvalidData,
                        WindowError::SyncForegroundRefreshRequired,
                        WindowError::DriverBlocked,
                        WindowError::InvalidImportOfNonDll,
                        WindowError::AccessDisabledWebblade,
                        WindowError::AccessDisabledWebbladeTamper,
                        WindowError::RecoveryFailure,
                        WindowError::AlreadyFiber,
                        WindowError::AlreadyThread,
                        WindowError::StackBufferOverrun,
                        WindowError::ParameterQuotaExceeded,
                        WindowError::DebuggerInactive,
                        WindowError::DelayLoadFailed,
                        WindowError::VdmDisallowed,
                        WindowError::UnidentifiedError,
                        WindowError::InvalidCruntimeParameter,
                        WindowError::BeyondVdl,
                        WindowError::IncompatibleServiceStdType,
                        WindowError::DriverProcessTerminated,
                        WindowError::ImplementationLimit,
                        WindowError::ProcessIsProtected,
                        WindowError::ServiceNotifyClientLagging,
                        WindowError::DiskQuotaExceeded,
                        WindowError::ContentBlocked,
                        WindowError::IncompatibleServicePrivilege,
                        WindowError::AppHang }
{
    SYSTEM_SELF_CLASS_IS_VALID_1;
}

CLASS_INVARIANT_PARENT_IS_VALID_DEFINE(System, FormatErrorMessageUseDllMoudleAndLocalAllocTesting)

void System::FormatErrorMessageUseDllMoudleAndLocalAllocTesting::DoRunUnitTest()
{
    ASSERT_NOT_THROW_EXCEPTION_0(MainTest);
}

void System::FormatErrorMessageUseDllMoudleAndLocalAllocTesting::MainTest()
{
    ASSERT_NOT_THROW_EXCEPTION_0(FormatLastErrorUseDllMoudleAndLocalAllocTest);
}

void System::FormatErrorMessageUseDllMoudleAndLocalAllocTesting::FormatLastErrorUseDllMoudleAndLocalAllocTest()
{
    const DynamicLinkString kernel32Dll{ DYNAMIC_LINK_TEXT("kernel32"s) };
    auto module = LoadDynamicLibrary(kernel32Dll.c_str(), LoadLibraryType::NoFlags);

    for (auto flag = WindowError::Success; flag <= WindowError::AppHang; ++flag)
    {
        const auto iter = windowErrorFlags.find(flag);
        WindowsHLocal errorMessage{ nullptr };

        if (iter != windowErrorFlags.cend())
        {
            ASSERT_TRUE(FormatErrorMessage(errorMessage, module, flag));
            ASSERT_UNEQUAL_NULL_PTR(errorMessage);
        }
        else
        {
            if (FormatErrorMessage(errorMessage, module, flag))
            {
                ASSERT_UNEQUAL_NULL_PTR(errorMessage);
            }
            else
            {
                ASSERT_EQUAL_NULL_PTR(errorMessage);
            }
        }

        if (errorMessage != nullptr)
        {
            ASSERT_TRUE(LocalMemoryFree(errorMessage));
        }
    }

    ASSERT_TRUE(FreeDynamicLibrary(module));
}
